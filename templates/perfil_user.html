{% extends "base.html" %}
{% load el_pagination_tags static %}
{% block content %}

<style type="text/css">
	.nav-tabs > li.active > a, .nav-tabs > li.active > a:hover, .nav-tabs > li.active > a:focus {
    color: #555;
    cursor: default;
    background-color: #b5be14 !important;
    border: 1px solid #3d3a35 !important;
    border-bottom-color: transparent;
}

</style>
	<section class="section-grey small-padding">

        <!--begin container-->
        <div class="container detalle-user">

        	<div class="row">
        		<ol class="breadcrumb">
	        		<li>
	        			<a href="/accounts/profile/user/editar">Editar perfil</a>
	        		</li>
	        		<li>
	        			<a href="/accounts/password/reset/">Resetear contraseña</a>
	        		</li>
                    <li>
                        <a href="/accounts/profile/crear/">Crear Organización</a>
                    </li>
	        	</ol>
        	</div>
        	<div class="row">
        		<div class="col-xs-12 col-sm-5">
        			<div class="panel panel-primary">
		        		<div class="panel-heading">
		                    <h3 class="panel-title display-inline">Perfil de Usuario</h3>

		                </div>
		        		<div class="panel-body no-padding">
		        			<ul class="list-group margin-bottom-0">
		                        <li class="list-group-item">
		                            <span><b> Nombre de usuario:</b> {{user.username}}</span>

		                        </li>
		                        <li class="list-group-item">
		                            <span><b> Nombre:</b> {% if user.first_name %}{{user.first_name}}{% else %}---{% endif %}</span>
		                        </li>
		                        <li class="list-group-item">
		                            <span><b> Apellido:</b> {% if user.last_name %}{{user.last_name}}{% else %}---{% endif %}</span>
		                        </li>
		                        <li class="list-group-item">
		                            <span><b> Correo:</b> {{user.email}} </span>
		                        </li>

		                    </ul>
		        		</div>
		        	</div>
        		</div>
        		<div class="col-xs-12 col-sm-7">
        			{% if organizaciones %}

        			<ul class="nav nav-tabs" id="myTab" role="tablist">
					  <li class="nav-item">
					    <a class="nav-link active panel-title" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Organizaciones</a>
					  </li>
					  <li class="nav-item">
					    <a class="nav-link panel-title" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Solicitar vinculación</a>
					  </li>
                      <li class="nav-item">
                        <a class="nav-link panel-title" id="profile-tab" data-toggle="tab" href="#profilepermisso" role="tab" aria-controls="profilepermisso" aria-selected="false">Permisos</a>
                      </li>
					</ul>
					<div class="tab-content" id="myTabContent">
					  <div class="tab-pane active" id="home" role="tabpanel" aria-labelledby="home-tab">
		        			<ul class="list-group margin-bottom-0">
		        				{% paginate 5 organizaciones %}
		        				{% for org in organizaciones %}
		        				<li class="list-group-item">

									<p>	<b>{{org.nombre}} </b><a href="{% url "detail-org" org.slug %}">Perfil </a>| <a href="{% url "editar-org" org.slug %}">Editar</a> | Usuarios: {% for users in org.usuario.all%} {{users}}{% if forloop.last%}{%else%},{%endif%}{% endfor %}
                                    </p>
		                        </li>
		                       {% endfor %}
		        			</ul>
		        			<nav class="Page navigation">
					            <ul class="pagination pull-right">
					                <li>
					                    {% show_pages %}
					                </li>
					            </ul>
					        </nav>
					  </div>
					  <div class="tab-pane" id="profile" role="tabpanel" aria-labelledby="profile-tab">
					  	<form method="POST" id="contact-form">{% csrf_token %}
                        {% if enviado == 1 %}
                            <div class="alert alert-success" role="alert">Su mensaje ha sido enviado correctamente!!!</div>
                            {% endif %}
                        <p>Enviar mensaje al administrador del sistema si desea que su perfil se asocie a una organización/especialista</p>
                        <p>Adjuntar información básica para el registro de la misma</p>
                        Organizacion: {{form1.cual_org}} <br>
                        Asunto: {{form1.asunto}}<br>
                        <input type="submit" name="Enviar" value="Enviar mensaje">
                    </form>
					  </div>

                      <div class="tab-pane" id="profilepermisso" role="tabpanel" aria-labelledby="profile-tab">

                        {% for org in organizaciones %}
                        <li class="list-group-item">
                            <p> <b>{{org.nombre}} </b> |
                                <a href="{% url "editar-permisos-user" org.slug %}">Editar Permiso</a>
                            </p>
                        </li>
                        {% endfor %}
                      </div>

					</div>

		        	{% else %}
		        	<form method="POST" id="contact-form">{% csrf_token %}
						{% if enviado == 1 %}
							<div class="alert alert-success" role="alert">Su mensaje ha sido enviado correctamente!!!</div>
							{% endif %}
						<p>Enviar mensaje al administrador del sistema si desea que su perfil se asocie a una organización/especialista</p>
						<p>Adjuntar información básica para el registro de la misma</p>
                        Organizacion: {{form1.cual_org}} <br>
						Asunto: {{form1.asunto}}<br>
						<input type="submit" name="Enviar" value="Enviar mensaje">
					</form>
				{% endif %}


        		</div>

        	</div>

        </div>
    </section>


{% endblock content %}

{% block extra_css %}
 <link rel="stylesheet" href="/static/css/bootstrap-select.min.css">
{% endblock extra_css %}
{% block extra_js %}
<script src="/static/js/bootstrap-select.min.js"></script>
<script type="text/javascript">
    $('#id_cual_org').addClass( "form-control" );
    $(document).ready(function() {
        $('#myTab li:first-child a').tab('show') // Select first tab

        $('#id_cual_org').selectpicker({
            style: 'btn-default',
            size: 4,
            liveSearch: 'true',
            title: 'Seleccione',
            selectedTextFormat: 'count',
            countSelectedText: '{0} seleccionados',
        });

    });

</script>
{% endblock extra_js %}
